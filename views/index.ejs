<!DOCTYPE html>
<html lang="en">

<head>
  <title>Home Page</title>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" />
  <link rel="stylesheet" href="/vendor/border-box.css" />
  <link rel="stylesheet" href="/styles/main.css" />
  <link rel="stylesheet" href="/styles/layout.css" />
  <link rel="stylesheet" href="/styles/nav.css">
  <link rel="stylesheet" href="/styles/header.css">

  <script src="/vendor/jquery-3.0.0.js"></script>
  <script defer src="/scripts/app.js"></script>
</head>

<body>

  <!-- Navbar pulled from partials/ directory -->
  <%- include('partials/_navbar') %>

  <header>
    <div id="searchBarStyling">

      <form action="/movies" method="GET">
        <span>Search: </span>
        <input type="text" name="query" placeholder="Movie Title">

        <!-- Sort -->
        <span>Sort by: </span>
        <select name="sort" id="sort_by">
          <option value="">--Select--</option>
          <option value="genre">Genre</option>
          <option value="year">Year</option>
          <option value="priceLowToHigh">Least Expensive</option>
          <option value="priceHighToLow">Most Expensive</option>
        </select>

        <button type="submit">Search</button>

        <!-- Advanced Features -->
        <div id="advanced_features">
        <h4>Advanced Filters:</h4>

        <!-- Filter for Genre -->
        <label for="select_genre">Genre:</label>
        <select id="select_genre" name="select_genre">
          <option value="0">Anything</option>
          <option value="1">Horror</option>
          <option value="2">Thriller</option>
          <option value="3">Comedy</option>
          <option value="4">Action</option>
          <option value="5">Family</option>
          <option value="6">Crime</option>
        </select>

        <!-- Max Price -->
        <label for="max_price">Max Price:</label>
        <input type="number" min="0" name="max_price" id="max_price" placeholder="$">

        <!-- Year -->
        <label for="year">Year:</label>
        <input type="number" min="1976" name="year" id="year" placeholder="1984">

        <!-- Quality -->
        <label for="min_quality">Minimum Quality:</label>
        <input type="number" min="1" max="5" name="min_quality" id="min_quality" placeholder="5">
        </div>

      </form>
    </div>
  </header>

  <main>

    <section>

    </section>

    <!-- products go below here! -->
    <section class = "product-feed">
      <% movies.forEach(movie => { %>

        <!-- Assign unique tag if movie is_sold === true -->
        <% if (movie.is_sold) { %>
        <div class="product-item-SOLD">
          <% } else { %>
            <div class="product-item">
            <% } %>

          <h2><%= movie.title %>
          <% if (movie.is_sold) { %>
            <%= '- SOLD!' %>
            <% } %>
          </h2>
          <p><%= movie.genre_name %></p>
          <p><%= movie.year %></p>
          <p>Rent now for: $<%= movie.price / 100%></p>
          <p>Movie quality: <%= movie.quality %></p>

          <!-- Delete Movie Button -->
           <% if (cookie.userType === 'admin') { %>
           <form action="/movies/<%= movie.movie_id %>/delete" method="POST" style="display:inline">
            <button type="submit" id="delete_button">Delete</button>
           </form>
          <% }%>

          <!-- Mark Movie as Sold Button -->
          <% if (cookie.userType === 'admin' && !movie.is_sold) { %>
          <form action="/movies/<%= movie.movie_id %>" method="POST" style="display:inline">
            <button type="submit" id="sold_button">Mark as SOLD!</button>
          </form>
          <% } %>

        </div>
      <% }) %>
    </section>


  </main>

</body>

</html>
